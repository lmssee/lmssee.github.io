<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-sidebar_reader docs-version-current docs-doc-page docs-doc-id-浏览器/交互" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">交互 | 泥豆君</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lmssee.github.io/icon/dev/android-chrome-512x512.png"><meta data-rh="true" name="twitter:image" content="https://lmssee.github.io/icon/dev/android-chrome-512x512.png"><meta data-rh="true" property="og:url" content="https://lmssee.github.io/reader/浏览器/交互"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="og:title" content="${title} ***"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-sidebar_reader-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-sidebar_reader-current"><meta data-rh="true" property="og:title" content="交互 | 泥豆君"><meta data-rh="true" name="description" content="输入"><meta data-rh="true" property="og:description" content="输入"><link data-rh="true" rel="icon" href="/icon/dev/favicon.ico"><link data-rh="true" rel="canonical" href="https://lmssee.github.io/reader/浏览器/交互"><link data-rh="true" rel="alternate" href="https://lmssee.github.io/reader/浏览器/交互" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://lmssee.github.io/reader/浏览器/交互" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"浏览器","item":"https://lmssee.github.io/reader/浏览器/"},{"@type":"ListItem","position":2,"name":"交互","item":"https://lmssee.github.io/reader/浏览器/交互"}]}</script><link rel="manifest" href="/icon/dev/site.webmanifest">
<script defer="defer" src="/pwa/main.js"></script><link rel="stylesheet" href="/assets/css/styles.4df53c52.css">
<script src="/assets/js/runtime~main.db228343.js" defer="defer"></script>
<script src="/assets/js/main.1623c83d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/icon/dev/logo.png"><div role="region" aria-label="跳到主要内容"><a class="skipToContent__j_j" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/icon/dev/logo.png" alt="泥豆君" class="themedComponent_q8Jn themedComponent--light_Whoz"><img src="/icon/dev/logo.png" alt="泥豆君" class="themedComponent_q8Jn themedComponent--dark_voRP"></div><b class="navbar__title text--truncate">泥豆君</b></a><a class="navbar__item navbar__link" href="/html">html</a><a class="navbar__item navbar__link" href="/css">css</a><a class="navbar__item navbar__link" href="/git">git</a><a class="navbar__item navbar__link" href="/mySQL">mySQL</a><a class="navbar__item navbar__link" href="/linux">linux</a><a class="navbar__item navbar__link" href="/markdown">markdown</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/reader">reader</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://earthnut.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">earthnut<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_Pdia"><use href="#theme-svg-external-link"></use></svg></a><a href="https://dobetter.pages.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">简约笔记<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_Pdia"><use href="#theme-svg-external-link"></use></svg></a><a href="https://react-source-code.pages.dev" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">react 源码学习<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_Pdia"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/MrMudBean/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_Pdia"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_N3m2 colorModeToggle_SsPF"><button class="clean-btn toggleButton_qC67 toggleButtonDisabled_GHxs" type="button" disabled="" title="浅色模式" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_Fv6p lightToggleIcon_ym6o"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_Fv6p darkToggleIcon_kJvk"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_Fv6p systemToggleIcon_H1yR"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_dqCX"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_eExm theme-layout-main"><div class="docsWrapper_e9E8"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sk1P" type="button"></button><div class="docRoot_LKA0"><aside class="theme-doc-sidebar-container docSidebarContainer_omeZ"><div class="sidebarViewport_bMvG"><div class="sidebar_PAPh"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_FfEt"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_Q0ee menu__link menu__link--sublist" href="/reader/正则/"><span title="正则" class="categoryLinkLabel_AqBC">正则</span></a><button aria-label="展开侧边栏分类 &#x27;正则&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_Q0ee menu__link menu__link--sublist menu__link--active" href="/reader/浏览器/"><span title="浏览器" class="categoryLinkLabel_AqBC">浏览器</span></a><button aria-label="折叠侧边栏分类 &#x27;浏览器&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reader/浏览器/简介"><span title="简介" class="linkLabel_VJZ7">简介</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/reader/浏览器/交互"><span title="交互" class="linkLabel_VJZ7">交互</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reader/浏览器/控制台"><span title="控制台" class="linkLabel_VJZ7">控制台</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reader/浏览器/异常"><span title="异常" class="linkLabel_VJZ7">异常</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reader/浏览器/处理"><span title="处理" class="linkLabel_VJZ7">处理</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reader/浏览器/调试技巧"><span title="调试技巧" class="linkLabel_VJZ7">调试技巧</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_Q0ee menu__link menu__link--sublist" href="/reader/扩展阅读/"><span title="扩展阅读" class="categoryLinkLabel_AqBC">扩展阅读</span></a><button aria-label="展开侧边栏分类 &#x27;扩展阅读&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_Q0ee menu__link menu__link--sublist" href="/reader/http 协议/"><span title="http 协议" class="categoryLinkLabel_AqBC">http 协议</span></a><button aria-label="展开侧边栏分类 &#x27;http 协议&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton__4HM"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_FqDl"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_ppDY"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_cPDD"><div class="docItemContainer_SOmV"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_ge2p" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_ziaM"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/reader/浏览器/"><span>浏览器</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">交互</span></li></ul></nav><div class="tocCollapsible_Bi0v theme-doc-toc-mobile tocMobile_A1Vn"><button type="button" class="clean-btn tocCollapsibleButton_gShC">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>请求</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_OZqL" id="输入">输入<a href="#输入" class="hash-link" aria-label="输入的直接链接" title="输入的直接链接" translate="no">​</a></h2>
<p>当在地址栏输入一个查询关键字的时候，地址栏会判断，输入的是需要搜索的关键字，还是请求的 URL 。如果是关键字，地址栏会结合浏览器所设置的搜索引擎来生成一个带输入关键字的 URL , 然后开始发起 URL
请求。如果浏览器判断输入的是合法的 URL ，那么浏览器也会进行相应的修正，比如为 lmssee.com 加上协议，合成完整的 URL ： <code>https://lmssee.com</code> 然后开始请求。</p>
<p>当用户输入关键字并键入回车之后，这意味着当前页面即将要被替换成新的页面，不过在这个流程继续之前，浏览器还给了当前页面一次执行 beforeunload 事件的机会， beforeunload
事件允许页面在退出之前执行一些数据清理操作，还可以询问用户是否要离开当前页面，比如当前页面可能有未提交完成的表单等情况，因此用户可以通过 beforeunload 事件来取消导航，让浏览器不再执行任何后续工作。</p>
<h2 class="anchor anchorTargetStickyNavbar_OZqL" id="url-请求过程">URL 请求过程<a href="#url-请求过程" class="hash-link" aria-label="URL 请求过程的直接链接" title="URL 请求过程的直接链接" translate="no">​</a></h2>
<p>此时，开始进入页面资源请求过程。浏览器会进行进程间通信 (IPC)
把 URL 请求发送到网络进程。当网络进程接收到 URL 请求时，首先网络进程会查找本地是否具有缓存。如果具备缓存资源，那么直接返回浏览器该缓存资源，否则直接进入网络请求流程。</p>
<p>请求的第一步会进入 DNS 解析，来获取域名的 IP 地址。域名解析需要访问一系列的域名解析服务器，来把该域名翻译成为 TCP/IP 协议的 IP 地址。</p>
<p>为提高 performance ，域名解析的过程中会设置多级的缓存，浏览器首先看一下自己的缓存里有没有，如果没有就向操作系统的缓存要，还没有就检查本机域名解析文件
hosts 。如果本地都找不到缓存，就会去顶级域名服务器“ com ”去查找，并且将该结果缓存。</p>
<p>当 Client 利用 IP 地址和服务器建立 TCP 连接后，浏览器会构建请求行 、 请求头等信息，并将该域名相关的 Cookie 等数据附加到请求头中，向服务器发送请求信息。
服务器接收到请求信息后，会根据请求信息生成响应数据（包括响应行 、 响应头和响应体等信息），并发给网络进程。等网络进程接收了响应行和响应头之后，就开始解析响应的内容了。</p>
<p><em>重定向</em></p>
<p>在接收到服务器返回的响应头后，网络进程开始解析响应头，如果发现返回的状态码是 301 或者 302 ，那么说明服务器需要浏览器重定向到其他 URL 。这时网络进程会从响应头的 Location
字段里面读取重定向的地址，然后再发起新的 HTTP 或者 HTTPS 请求，重头开始。如果响应行是 200 ，那么表示浏览器可以继续处理该请求。</p>
<p><em>应数据类型处理</em></p>
<p>通常 URL 请求的数据类型会包含 HTML 页面，或者下载数据类型。响应头中的 Content-type 会告知浏览器返回的数据类型。如 Content-type ： text/html 表示返回数据
类型为 HTML 格式， Content-Type ： application/octet-stream 表示返回数据类型为字节流类型，浏览器按照下载类型来处理。不同的
Content-Type 字段，浏览器后续处理流程会有所不同。如果是下载类型，那么浏览器会将请求任务提交给下载管理器，同时关闭导航流程。如果是 HTML 浏览器的导航流程还会继续，并通知渲染进程开始进行渲染页面。</p>
<h2 class="anchor anchorTargetStickyNavbar_OZqL" id="准备渲染进程">准备渲染进程<a href="#准备渲染进程" class="hash-link" aria-label="准备渲染进程的直接链接" title="准备渲染进程的直接链接" translate="no">​</a></h2>
<p>默认情况下， Chrome 会为每个页面分配一个渲染进程，也就是说，每打开一个新页面就会配套创建一个新的渲染进程。但是，也有一些例外，在某些情况下，浏览器会让多个页面直接运行在同一个渲染进程中。</p>
<p>当从新的页面打开另外一个页面，并且这些页面属于同一个站点 (same-site) 的话 , 那么新页面会复用父页面的渲染进程 (process-per-site-instance) 。</p>
<h2 class="anchor anchorTargetStickyNavbar_OZqL" id="提交文档">提交文档<a href="#提交文档" class="hash-link" aria-label="提交文档的直接链接" title="提交文档的直接链接" translate="no">​</a></h2>
<p>渲染进程准备好之后，它就会通知浏览器进程，可以替换当前旧的文档了，具体地讲，需要经过下列几个步骤 :</p>
<ul>
<li class="">首先“提交文档”的消息是由渲染进程发出给浏览器进程的，这是告诉浏览器进程，它已经准备好了，可以执行解析渲染等后续操作了浏览器进程接收到当前渲染进程的“提交文档”消息后，便开始清理当前的旧文档，然后会发出“确认提交”的消息给渲染进程。同时，浏览器进程会更新浏览器界面状态，包括了安全状态 、 地址栏的
URL 、 前进后退的历史状态，并更新 Web 页面</li>
<li class="">当渲染进程接收到“确认提交”的消息后，便开始执行解析数据 、 下载子资源等后续流程，并实时向浏览器进程更新最新的渲染状态</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_OZqL" id="渲染阶段">渲染阶段<a href="#渲染阶段" class="hash-link" aria-label="渲染阶段的直接链接" title="渲染阶段的直接链接" translate="no">​</a></h2>
<p>文档被提交，渲染进程便开始页面解析和子资源加载了。该过程主要涉及 HTML,CSS,JavaScript 如何生成页面。从解析 *.html 文件，生成 DOM, CssDOM, Render Tree, 再到计算布局 (layout) ，绘制 (paint) ，合成页面 (composite layers), 每个过程都涉及到优化问题。开发者应该注重用户体验，防止页面卡顿，使用 JavaScript 优化动画流程，优化样式表等来防止强制同步布局等。</p>
<p><em>生成 Render Tree</em></p>
<p>然后根据 CSS 的样式规则，我们依次得到各 Node 与对应的 CSS 样式结合，再生成 Render Tree 。其中 Render Tree 与 DOM tree 非常类似，不同的是 Render tree
没有 head 也不含任何脚本。如果 CSS 样式中设置了 <code>{display: none; }</code> 属性的话，该 node 也会从 Render tree 中移掉，对于一些伪元素，例如添加了</p>
<div class="language-css codeBlockContainer_o92t theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_Lpmw"><pre tabindex="0" class="prism-code language-css codeBlock_a5dN thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_ILlf codeBlockLinesWithNumbering_QWXL" style="counter-reset:line-count 0"><span class="token-line codeLine_BcgL" style="color:#393A34"><span class="codeLineNumber_jUSO"></span><span class="codeLineContent_cfgZ"><span class="token selector" style="color:#00009f">h1</span><span class="token selector pseudo-element" style="color:#00009f">:after</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_BcgL" style="color:#393A34"><span class="codeLineNumber_jUSO"></span><span class="codeLineContent_cfgZ"><span class="token plain">  </span><span class="token property" style="color:#36acaa">content</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;this will be visible&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_BcgL" style="color:#393A34"><span class="codeLineNumber_jUSO"></span><span class="codeLineContent_cfgZ"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></span><br></span></code></pre></div></div>
<p>属性， Render tree 会添加该 node, 但 DOM 并不会包含这个 node 。需要注意的是，只有实际显示在网页上的元素才会进入 Render
tree 。</p>
<p><em>计算布局</em></p>
<p>当浏览器知道哪个规则适用于哪个元素后，就会开始进入布局计算阶段。其中具体样式适用元素的规则需要根据 CSS
的继承规则和层叠规则计算。我们可以通过盒模型，排版等计算每个节点坐标，大小，得到页面的布局。这一过程比较复杂，该计算过程也称为回流 (reflow) 。</p>
<p><em>光栅化</em></p>
<p>得到计算的布局之后，便可以矢量光栅化到图形 (vector 2 raster) ，矢量的栅格化到图形 render tree 通过计算边框 、 绘制文本 、 绘制阴影 、 白线 、 绘制位图最终形成的展示内容。</p>
<h2 class="anchor anchorTargetStickyNavbar_OZqL" id="合成页面">合成页面<a href="#合成页面" class="hash-link" aria-label="合成页面的直接链接" title="合成页面的直接链接" translate="no">​</a></h2>
<p>浏览器会根据需要创建多个图层，单独绘制这些图层并合成层。</p>
<p>对于绘制和合成页面的中间过程，还会涉及到跨进程操作。通常，绘制过程中，都是在一系列的网格图块（ tiles ）中实现的。图层会将其本身以及图块上传到 GPU 中进行栅格化加速生成。使用 GPU
生成位图的过程叫快速栅格化，或者
GPU
栅格化，生成的位图被保存在 GPU 内存中。 GPU 操作是运行在 GPU 进程中，如果栅格化操作使用了 GPU ，那么最终生成位图的操作是在 GPU 中完成的。</p>
<h2 class="anchor anchorTargetStickyNavbar_OZqL" id="123">123<a href="#123" class="hash-link" aria-label="123的直接链接" title="123的直接链接" translate="no">​</a></h2>
<h2 class="anchor anchorTargetStickyNavbar_OZqL" id="http-请求过程">HTTP 请求过程<a href="#http-请求过程" class="hash-link" aria-label="HTTP 请求过程的直接链接" title="HTTP 请求过程的直接链接" translate="no">​</a></h2>
<ul>
<li class="">浏览器从地址栏的输入中获得服务器的 IP 地址和端口号</li>
<li class="">浏览器用 TCP 的三次握手与服务器建立连接</li>
<li class="">浏览器向服务器发送拼好的报文</li>
<li class="">服务器收到报文后处理请求，同样拼好报文再发给浏览器；浏览器解析报文，渲染输出页面</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_OZqL" id="页面渲染过程">页面渲染过程<a href="#页面渲染过程" class="hash-link" aria-label="页面渲染过程的直接链接" title="页面渲染过程的直接链接" translate="no">​</a></h2>
<ul>
<li class="">根据 HTML 构建 DOM 树</li>
<li class="">根据 CSS 样式表，计算 DOM 树所有节点样式并构建 Render tree 。</li>
<li class="">计算 Layout 布局</li>
<li class="">根据 Layout 进行分层</li>
<li class="">各图层分成图块，并在 GPU 中转换图块成位图</li>
<li class="">生成页面，并显示到显示器</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_OZqL" id="交互">交互<a href="#交互" class="hash-link" aria-label="交互的直接链接" title="交互的直接链接" translate="no">​</a></h2>
<p>首次载入网站进行访问时，浏览器和服务器的完整交互步骤如下。</p>
<ul>
<li class="">在浏览器中请求访问网站 <code>https://lmssee.cn/about</code></li>
<li class="">服务器返回 index.html 页面</li>
<li class="">浏览器解析 index.html 页面，请求页面中的所有资源文件，包括 HTML 文件 、 CSS 文件 、 JavaScript 脚本文件 、 清单文件以及图片等</li>
<li class="">服务器端返回所有请求的资源文件</li>
<li class="">在浏览器中处理并请求清单中的所有项，包括 index.html 页面本身。如果页面内容过多，并且要求本地缓存所有的文件，这将是一个比较的大重复的请求过程</li>
<li class="">服务器返回所有要求本地缓存的文件</li>
<li class="">浏览器对本地缓存进行更新，存入包括页面本身在内的所有要求本地缓存的资源文件，并且触发一个事件，通知本地缓存被更新</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_OZqL" id="再次载入页面">再次载入页面<a href="#再次载入页面" class="hash-link" aria-label="再次载入页面的直接链接" title="再次载入页面的直接链接" translate="no">​</a></h2>
<p>首先访问网站首页完毕后，浏览器将清单中的列表文件完全载入缓存。如果再次打开浏览器访问该网站，并且 manifest 文件中的内容没有被修改过，它们的交互过程如下 。</p>
<ul>
<li class="">浏览器会再次请求访问网站 <code>https://lmssee.cn/about</code></li>
<li class="">浏览器会发现这个页面被本地缓存，于是使用本地缓存中的 clock.html 页面</li>
<li class="">浏览器解析 clock.html 网页，使用所有本地缓存中的资源文件</li>
<li class="">浏览器向服务器请求 manifest 文件</li>
<li class="">服务器返回一个 304 代码，通知浏览器 manifest 文件没有发生变化</li>
</ul>
<p>如果再次通过浏览器访问网站页面，并且 manifest 文件的内容已经被修改过了，它们的交互过程如下</p>
<ul>
<li class="">浏览器会再次请求访问 <code>https://lmssee.cn/about</code></li>
<li class="">浏览器会发现这个页面被本地缓存，于是使用本地缓存中的 index.html 页面</li>
<li class="">浏览器解析 index.html 网页，使用所有本地缓存中的资源文件</li>
<li class="">浏览器向服务器请求 manifest 文件</li>
<li class="">服务器返回更新过的 manifest 文件</li>
<li class="">浏览器会处理 manifest 文件，发现该文件已经被更新，于是请求所有要求本地缓存的资源文件，包含 index.html 页面本身</li>
<li class="">浏览器返回要求进行本地缓存的资源文件</li>
<li class="">浏览器对本地缓存进行更新，存入所有新的资源文件，并且触发一个事件，通知本地缓存被更新</li>
</ul>
<p>即使资源文件被修改过了，任何之前载入的资源都不会发生变化。例如，图片不会改变，旧的 JavaScript
函数也不会改变。也就是说，更新过后的本地缓存中的内容还不能被使用，只有重新打开这个页面的时候才会使用更新过的资源文件</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/reader/浏览器/简介"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">简介</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/reader/浏览器/控制台"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">控制台</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_YP7k thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#输入" class="table-of-contents__link toc-highlight">输入</a></li><li><a href="#url-请求过程" class="table-of-contents__link toc-highlight">URL 请求过程</a></li><li><a href="#准备渲染进程" class="table-of-contents__link toc-highlight">准备渲染进程</a></li><li><a href="#提交文档" class="table-of-contents__link toc-highlight">提交文档</a></li><li><a href="#渲染阶段" class="table-of-contents__link toc-highlight">渲染阶段</a></li><li><a href="#合成页面" class="table-of-contents__link toc-highlight">合成页面</a></li><li><a href="#123" class="table-of-contents__link toc-highlight">123</a></li><li><a href="#http-请求过程" class="table-of-contents__link toc-highlight">HTTP 请求过程</a></li><li><a href="#页面渲染过程" class="table-of-contents__link toc-highlight">页面渲染过程</a></li><li><a href="#交互" class="table-of-contents__link toc-highlight">交互</a></li><li><a href="#再次载入页面" class="table-of-contents__link toc-highlight">再次载入页面</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>