"use strict";(self.webpackChunknotebook=self.webpackChunknotebook||[]).push([[29237],{24557:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>h,contentTitle:()=>o,default:()=>l,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"\u573a\u666f\u56fe","title":"\u573a\u666f\u56fe","description":"three \u7684\u6838\u5fc3\u5c31\u662f\u573a\u666f\u56fe\uff08 scene graph \uff09","source":"@site/three/\u573a\u666f\u56fe.mdx","sourceDirName":".","slug":"/\u573a\u666f\u56fe","permalink":"/three/\u573a\u666f\u56fe","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\u573a\u666f\u56fe"},"sidebar":"t3pBV2E39OVsXlCI","previous":{"title":"\u56fe\u5143","permalink":"/three/\u56fe\u5143"},"next":{"title":"\u6750\u8d28","permalink":"/three/\u6750\u8d28"}}');var s=t(47259),i=t(29087);const a={title:"\u573a\u666f\u56fe"},o="\u573a\u666f\u56fe",h={},c=[];function d(e){const n={a:"a",code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u573a\u666f\u56fe",children:"\u573a\u666f\u56fe"})}),"\n",(0,s.jsx)(n.p,{children:"three \u7684\u6838\u5fc3\u5c31\u662f\u573a\u666f\u56fe\uff08 scene graph \uff09"}),"\n",(0,s.jsxs)(n.p,{children:["\u4e0b\u9762\u6a21\u62df\u5730\u6708\u5173\u7cfb\u5236\u4f5c\u7684 ",(0,s.jsx)(n.a,{href:"https://threejs.org/manual/#zh/scenegraph",children:"\u4e09\u661f\u8fd0\u8f6c\u56fe"})," \uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// \u6784\u5efa\u6e32\u67d3\u5668\nconst renderer = new three.WebGLRenderer({ antialias: true });\nrenderer.setSize(window.innerWidth, window.innerHeight - 80);\n// \u8bbe\u7f6e\u6e32\u67d3\u5668\u5206\u8fa8\u7387\u4e3a\u5c4f\u5e55\u5206\u8fa8\u7387 \u3002\u4e0d\u5efa\u8bae//\nrenderer.setPixelRatio(window.devicePixelRatio); // \u8bbe\u7f6e\u6444\u50cf\u5934\nconst camera = new three.PerspectiveCamera(\n  50,\n  window.innerWidth / window.innerHeight,\n  1,\n  500,\n);\ncamera.position.set(0, 50, 0);\ncamera.up.set(0, 0, 1);\ncamera.lookAt(0, 0, 0); // \u5c06\u751f\u6210\u7684\u89c6\u56fe\u753b\u5230\u753b\u5e03\u4e0a\nconst canvas = renderer.domElement;\ncanvas.id = canvasId; // \u521b\u5efa\u573a\u666f\nconst scene = new three.Scene();\nconst objects: any = [];\nconst solarSystem = new three.Object3D();\nscene.add(solarSystem);\nobjects.push(solarSystem); // \u51c6\u5907\u592a\u9633\u56fe\u5143\nconst sphereGeometry = new three.SphereGeometry(1, 20, 6); // \u51c6\u5907\u592a\u9633\u6750\u8d28\nconst sunMaterial = new three.MeshPhongMaterial({ emissive: 0xffff00 }); // \u5c06\u56fe\u5143\u548c\u6750\u8d28\u6df7\u5408\nconst sunMesh = new three.Mesh(sphereGeometry, sunMaterial);\nsunMesh.scale.set(5, 5, 5);\nsolarSystem.add(sunMesh);\nobjects.push(sunMesh);\nconst earthOrbit = new three.Object3D();\nearthOrbit.position.x = 10;\nsolarSystem.add(earthOrbit);\nobjects.push(earthOrbit); // \u8bbe\u7f6e\u5730\u7403\u6750\u8d28\nconst earthMaterial = new three.MeshPhongMaterial({\n  color: 0x2233ff,\n  emissive: 0x112244,\n});\nconst earthMesh = new three.Mesh(sphereGeometry, earthMaterial);\nearthOrbit.add(earthMesh);\nobjects.push(earthMesh);\nconst moonOrbit = new three.Object3D();\nmoonOrbit.position.x = 2;\nearthOrbit.add(moonOrbit); // \u8bbe\u7f6e\u6708\u7403\u6750\u8d28\nconst moonMaterial = new three.MeshPhongMaterial({\n  color: 0x8888,\n  emissive: 0x222222,\n});\nconst moonMesh = new three.Mesh(sphereGeometry, moonMaterial);\nmoonMesh.scale.set(0.5, 0.5, 0.5);\nmoonOrbit.add(moonMesh);\nobjects.push(moonMesh);\nclass AxisGridHelper {\n  grid: three.GridHelper;\n  axes: three.AxesHelper;\n  private _visible: any;\n  constructor(node: any, units = 10) {\n    const axes = new three.AxesHelper();\n    axes.material.depthTest = false;\n    axes.renderOrder = 2;\n    node.add(axes);\n    const grid = new three.GridHelper(units, units);\n    grid.material.depthTest = false;\n    grid.renderOrder = 1;\n    node.add(grid);\n    this.grid = grid;\n    this.axes = axes;\n    this.visible = false;\n  }\n  get visible() {\n    return;\n    this._visible;\n  }\n  set visible(v) {\n    this._visible = this.grid.visible = v;\n    this.axes.visible = v;\n  }\n}\nconst gui = new GUI();\nfunction makeAxisGrid(node: any, label: any, units: any) {\n  const helper = new AxisGridHelper(node, units);\n  gui.add(helper, 'visible').name(label);\n} // \u751f\u6210 gui\nmakeAxisGrid(solarSystem, 'solarSystem', 25);\nmakeAxisGrid(sunMesh, 'sunMesh', 25);\nmakeAxisGrid(earthOrbit, 'earthOrbit', 25);\nmakeAxisGrid(earthMesh, 'earthMesh', 25);\nmakeAxisGrid(moonOrbit, 'moonOrbit', 25);\nmakeAxisGrid(moonMesh, 'moonMesh', 25); // \u6dfb\u52a0\u706f\u5149\nscene.add(new three.PointLight(0xffffff, 3)); // \u6267\u884c\u52a8\u753b\nfunction render(time: any) {\n  time *= 0.001;\n  if (resizeRendererToDisplaySize(renderer)) {\n    camera.aspect = canvas.clientWidth / canvas.clientHeight;\n    camera.updateProjectionMatrix();\n  }\n  objects.forEach((obj: any) => {\n    obj.rotation.y = time;\n  }); // \u91cd\u65b0\u6e32\u67d3\n  renderer.render(scene, camera); // \u9012\u5f52\u8c03\u7528\u81ea\u5df1\uff0c\u6267\u884c\u52a8\u753b\n  requestAnimationFrame(render);\n}\nrequestAnimationFrame(render); // \u6302\u8f7d canvas\ndocument.querySelector('#index')!.appendChild(canvas);\n/** \u5224\u65ad\u662f\u5426\u9700\u8981\u8bbe\u7f6e\u6e32\u67d3\u5668\u7684\u5c3a\u5bf8 */\nfunction resizeRendererToDisplaySize(renderer: any) {\n  const pixelRatio = window.devicePixelRatio;\n  const width = (canvas.clientWidth * pixelRatio) | 0;\n  const height = (canvas.clientHeight * pixelRatio) | 0;\n  const needResize = canvas.width !== width || canvas.height !== height;\n  if (needResize) renderer.setSize(width, height, false);\n  return needResize;\n}\n\n"})})]})}function l(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},29087:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var r=t(96363);const s={},i=r.createContext(s);function a(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);