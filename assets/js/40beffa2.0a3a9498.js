"use strict";(globalThis.webpackChunknotebook=globalThis.webpackChunknotebook||[]).push([[37025],{99412(n,e,t){t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"XHR 2/\u4e00\u4e9b","title":"\u4e00\u4e9b","description":"\u63a5\u6536 json","source":"@site/js/XHR 2/\u4e00\u4e9b.mdx","sourceDirName":"XHR 2","slug":"/XHR 2/\u4e00\u4e9b","permalink":"/XHR 2/\u4e00\u4e9b","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\u4e00\u4e9b"},"sidebar":"WabgeZrdzehcrQF7","previous":{"title":"\u91cd\u6784","permalink":"/XHR 2/\u91cd\u6784"},"next":{"title":"history","permalink":"/history/"}}');var i=t(56730),s=t(25502);const o={title:"\u4e00\u4e9b"},a="\u4f7f\u7528\u706f\u6807",l={},c=[{value:"\u63a5\u6536 json",id:"\u63a5\u6536-json",level:2},{value:"\u4e8c\u8fdb\u5236",id:"\u4e8c\u8fdb\u5236",level:2},{value:"\u63a5\u6536 XML \u6570\u636e",id:"\u63a5\u6536-xml-\u6570\u636e",level:2},{value:"post",id:"post",level:2},{value:"get",id:"get",level:2}];function u(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"\u4f7f\u7528\u706f\u6807",children:"\u4f7f\u7528\u706f\u6807"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",metastring:"showLineNumbers",children:'<!DOCTYPE html>\n<html>\n  <head>\n    <title></title>\n    <style type="text/css">\n      #login {\n        position: relative;\n        width: 300px;\n      }\n      #title {\n        position: absolute;\n        right: 20px;\n        top: 80px;\n      }\n    </style>\n\n    window.onload = function() {var b = document.getElementById("submit");\n    b.onclick = login;}var login = function() {var user =\n    document.getElementById("user");var pass = document.getElementById("pass");\n    var s = "server.php?user=" + user.value + "&pass=" +\n    pass.value;imgRequest(s);} //img \u5f02\u6b65\u901a\u4fe1\u51fd\u6570 var imgRequest = function(url)\n    { if (typeof url != "string") return;var image = new Image();image.src =\n    url;image.onload = function() {var title = document.getElementById("title");\n    title.innerHTML = "";if (this.width > 2) {console.log(" \u767b\u5f55\u6210\u529f ");var\n    image1 = new Image();image1.src = "2.png"; title.appendChild(image1);} else\n    {console.log(" \u4f60\u8f93\u5165\u7684\u7528\u6237\u540d\u6216\u5bc6\u7801\u6709\u8bef\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165 ");var image1 = new\n    Image();image1.src = "1.png"; title.appendChild(image1);}};image.onerror =\n    function() {console.log(" \u52a0\u8f7d\u5931\u8d25 ");}; }\n\n    <meta charset="utf-8" />\n  </head>\n  <body>\n    <div id="login">\n      <h1>\u7528\u6237\u767b\u5f55</h1>\n      \u7528\u6237\u540d <input name="" id="user" type="text" /> \u5bc6\u3000\u7801\n      <input name="" id="pass" type="password" />\n      <input name="submit" type="button" id="submit" value=" \u63d0\u4ea4 " /><span\n        id="title"\n      ></span>\n    </div>\n  </body>\n</html>\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u63a5\u6536-json",children:"\u63a5\u6536 json"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",metastring:"showLineNumbers",children:'<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title>test</title>\n\n    function createXHR() { var XHR = [ function () { return new\n    XMLHttpRequest(); }, function () { return new\n    ActiveXObject(\'Msxml2.XMLHTTP\'); }, function () { return new\n    ActiveXObject(\'Msxml3.XMLHTTP\'); }, function () { return new\n    ActiveXObject(\'Microsoft.XMLHTTP\'); }, ]; var xhr = null; for (var i = 0; i\n    < XHR.length; i++) { try { xhr = XHR[i](); } catch (e) { continue; } break;\n    } return; xhr; } function JSONtoString(data) { var a = []; if\n    (data.constructor == Array) { for (var i = 0; i < data.length; i++) {\n    a.push(data[i].name + \'=\' + encodeURIComponent(data[i].value)); } } else {\n    for (var i in data) { a.push(i + \'=\' + encodeURIComponent(data[i])); } }\n    return a.join(\'&\'); }\n  </head>\n  <body>\n    <input name="submit" type="button" id="submit" value=" \u5411\u670d\u52a1\u5668\u53d1\u51fa\u8bf7\u6c42 " />\n\n    window.onload = function() { var b =\n    document.getElementsByTagName("input")[0]; b.onclick = function() { var xhr\n    = createXHR(); xhr.open("GET", "server.js", true); xhr.onreadystatechange =\n    function() { if (xhr.readyState == 4) { if (xhr.status == 200 | | xhr.status\n    == 0) { var info = xhr.responseText; var o = eval("(" + info + ")");\n    console.log(info); console.log(o.user); } } } xhr.send(); } }\n  </body>\n</html>\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u4e8c\u8fdb\u5236",children:"\u4e8c\u8fdb\u5236"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",metastring:"showLineNumbers",children:'<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset="utf-8" />\n    <title></title>\n\n    function uploadFile() { var formData = new FormData(); var files =\n    document.getElementById(\'file1\').files; for (var i = 0; i < files.length;\n    i++) { var file = files[i]; formData.append(\'myfile[]\', file); } var xhr =\n    new XMLHttpRequest(); xhr.open(\'POST\', \'test.php\', true); xhr.onload =\n    function (e) { if (this.status == 200) {\n    document.getElementById(\'result\').innerHTML = this.response; } };\n    xhr.send(formData); }\n  </head>\n  <body>\n    <form id="form1" enctype="multipart/form-data">\n      \u9009\u62e9\u6587\u4ef6 <input type="file" id="file1" name="file" multiple />\n      <input type="button" value=" \u53d1\u9001 " onclick="uploadFile();" />\n    </form>\n    <output id="result"></output>\n  </body>\n</html>\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u63a5\u6536-xml-\u6570\u636e",children:"\u63a5\u6536 XML \u6570\u636e"}),"\n",(0,i.jsx)(e.p,{children:"\u5728 XMLHttpRequest 1.0 \u7248\u672c\u4e2d\u53ef\u4ee5\u901a\u8fc7 responseBody \u3001 responseStream \u3001 responseText \u3001 responseXML \u5c5e\u6027\u83b7\u53d6\u54cd\u5e94\u4fe1\u606f\u3002"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u54cd\u5e94\u4fe1\u606f"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"\u55ef"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"responseBody"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"\u5c06\u54cd\u5e94\u4fe1\u606f\u6b63\u6587\u4ee5 Unsigned Byte \u6570\u7ec4\u5f62\u5f0f\u8fd4\u56de"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"responseStream"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"\u4ee5 ADO Stream \u5bf9\u8c61\u7684\u5f62\u5f0f\u8fd4\u56de\u54cd\u5e94\u4fe1\u606f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"responseText"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"\u5c06\u54cd\u5e94\u4fe1\u606f\u4ee5\u5b57\u7b26\u4e32\u8fd4\u56de"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"responseXML"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"\u5c06\u54cd\u5e94\u4fe1\u606f\u683c\u5f0f\u5316\u4e3a XML \u6587\u6863\u8fd4\u56de"})]})]})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-html",metastring:"showLineNumbers",children:"<!DOCTYPE html>\n<html>\n  <head>\n    <meta charset=\"utf-8\" />\n    <title>test</title>\n\n    // \u521b\u5efa XMLHttpRequest \u5bf9\u8c61 // \u53c2\u6570\uff1a\u65e0\uff1b\u8fd4\u56de\u503c\uff1a XMLHttpRequest \u5bf9\u8c61\n    function createXHR() { var XHR = // \u517c\u5bb9\u4e0d\u540c\u6d4f\u89c8\u5668\u548c\u7248\u672c\u7684\u521b\u5efa\u51fd\u6570\u6570\u7ec4 [\n    function () { return new XMLHttpRequest(); }, function () { return new\n    ActiveXObject('Msxml2.XMLHTTP'); }, function () { return new\n    ActiveXObject('Msxml3.XMLHTTP'); }, function () { return new\n    ActiveXObject('Microsoft.XMLHTTP'); }, ]; var xhr = null; for (var i = 0; i\n    < XHR.length; i++) { // \u5c1d\u8bd5\u8c03\u7528\u51fd\u6570\uff0c\u5982\u679c\u6210\u529f\u5219\u8fd4\u56de XMLHttpRequest\n    \u5bf9\u8c61\uff0c\u5426\u5219\u7ee7\u7eed\u5c1d\u8bd5 try { xhr = XHR[i](); } catch (e) { continue; //\n    \u5982\u679c\u53d1\u751f\u5f02\u5e38\uff0c\u5219\u7ee7\u7eed\u4e0b\u4e00\u4e2a\u51fd\u6570\u8c03\u7528 } break; // \u5982\u679c\u6210\u529f\uff0c\u5219\u4e2d\u6b62\u5faa\u73af } return\n    xhr; // \u8fd4\u56de\u5bf9\u8c61\u5b9e\u4f8b } // \u628a JSON \u6570\u636e\u8f6c\u6362\u4e3a\u4e32\u884c\u5b57\u7b26\u4e32 // \u53c2\u6570\uff1a data\n    \u8868\u793a\u6570\u7ec4\u6216\u5bf9\u8c61\u7c7b\u578b\u6570\u636e\uff1b\u8fd4\u56de\u503c\uff1a\u4e32\u884c\u5b57\u7b26\u4e32 function JSONtoString(data) { var\n    a = []; // \u4e34\u65f6\u6570\u7ec4 if (data.constructor == Array) { // \u5904\u7406\u6570\u7ec4 for (var i\n    = 0; i < data.length; i++) { a.push(data[i].name + '=' +\n    encodeURIComponent(data[i].value)); } } else { // \u5904\u7406\u5bf9\u8c61 for (var i in\n    data) a.push(i + '=' + encodeURIComponent(data[i])); } return a.join('&');\n    //\u628a\u6570\u7ec4\u8f6c\u6362\u4e3a\u4e32\u884c\u5b57\u7b26\u4e32\uff0c\u5e76\u8fd4\u56de }\n  </head>\n\n  <body>\n    <input name=\"submit\" type=\"button\" id=\"submit\" value=\" \u5411\u670d\u52a1\u5668\u53d1\u51fa\u8bf7\u6c42 \" />\n\n    window.onload = function () { // \u9875\u9762\u521d\u59cb\u5316 var b =\n    document.getElementsByTagName('input')[0]; b.onclick = function () { var xhr\n    = createXHR(); // \u5b9e\u4f8b\u5316 XMLHttpRequest \u5bf9\u8c61 xhr.open('GET', 'server2.php',\n    true); // \u5efa\u7acb\u8fde\u63a5\uff0c\u8981\u6c42\u5f02\u6b65\u54cd\u5e94 xhr.onreadystatechange = function () { //\n    \u7ed1\u5b9a\u54cd\u5e94\u72b6\u6001\u4e8b\u4ef6\u76d1\u542c\u51fd\u6570 if (xhr.readyState == 4) { // \u76d1\u542c readyState \u72b6\u6001\n    if (xhr.status == 200 || xhr.status == 0) { // \u76d1\u542c HTTP \u72b6\u6001\u7801 var info =\n    xhr.responseXML; console.log(\n    info.getElementsByTagName('the')[0].firstChild.data, ); // \u8fd4\u56de\u5143\u4fe1\u606f\u5b57\u7b26\u4e32\n    \"XML \u6570\u636e \" } } }; xhr.send(); // \u53d1\u9001\u8bf7\u6c42 }; };\n  </body>\n</html>\n"})}),"\n",(0,i.jsx)(e.h2,{id:"post",children:"post"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",metastring:"showLineNumbers",children:"// \u521b\u5efa XMLHttpRequest \u5bf9\u8c61\n// \u53c2\u6570\uff1a\u65e0\uff1b\u8fd4\u56de\u503c\uff1a XMLHttpRequest \u5bf9\u8c61\n//\n/**\n *\n */\nfunction createXHR() {\n  const XHR = [\n    //\u517c\u5bb9\u4e0d\u540c\u6d4f\u89c8\u5668\u548c\u7248\u672c\u7684\u521b\u5efa\u51fd\u6570\u6570\u7ec4\n    function () {\n      return new XMLHttpRequest();\n    },\n    function () {\n      return new ActiveXObject('Msxml2.XMLHTTP');\n    },\n    function () {\n      return new ActiveXObject('Msxml3.XMLHTTP');\n    },\n    function () {\n      return new ActiveXObject('Microsoft.XMLHTTP');\n    },\n  ];\n  let xhr = null;\n  for (let i = 0; i < XHR.length; i++) {\n    // \u5c1d\u8bd5\u8c03\u7528\u51fd\u6570\uff0c\u5982\u679c\u6210\u529f\u5219\u8fd4\u56de XMLHttpRequest \u5bf9\u8c61\uff0c\u5426\u5219\u7ee7\u7eed\u5c1d\u8bd5\n    try {\n      xhr = XHR[i]();\n    } catch (e) {\n      continue; // \u5982\u679c\u53d1\u751f\u5f02\u5e38\uff0c\u5219\u7ee7\u7eed\u4e0b\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\n    }\n    break; // \u5982\u679c\u6210\u529f\uff0c\u5219\u4e2d\u6b62\u5faa\u73af\n  }\n  return xhr; // \u8fd4\u56de\u5bf9\u8c61\u5b9e\u4f8b\n\n  window.onload = function () {\n    // \u9875\u9762\u521d\u59cb\u5316 var b = document.getElementsByTagName(\"input\")[0];\n    b.onclick = function () {\n      const url = 'server.php'; // \u8bbe\u7f6e\u8bf7\u6c42\u7684\u5730\u5740\n\n      const xhr = createXHR(); // \u5b9e\u4f8b\u5316 XMLHttpRequest \u5bf9\u8c61\n\n      xhr.open('POST', url, false); // \u5efa\u7acb\u8fde\u63a5\n      xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded'); // \u8bbe\u7f6e\u4e3a\u8868\u5355\u65b9\u5f0f\u63d0\u4ea4\n      xhr.send('callback=functionName'); //  \u53d1\u9001\u8bf7\u6c42\n      console.log(xhr.responseText); // \u63a5\u6536\u6570\u636e\n    };\n  };\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"get",children:"get"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-js",metastring:"showLineNumbers",children:"// \u521b\u5efa XMLHttpRequest \u5bf9\u8c61\n// \u53c2\u6570\uff1a\u65e0\uff1b\u8fd4\u56de\u503c\uff1a XMLHttpRequest \u5bf9\u8c61\n/**\n *\n */\nfunction createXHR() {\n  const XHR = [\n    //\u517c\u5bb9\u4e0d\u540c\u6d4f\u89c8\u5668\u548c\u7248\u672c\u7684\u521b\u5efa\u51fd\u6570\u6570\u7ec4\n    function () {\n      return new XMLHttpRequest();\n    },\n    function () {\n      return new ActiveXObject('Msxml2.XMLHTTP');\n    },\n    function () {\n      return new ActiveXObject('Msxml3.XMLHTTP');\n    },\n    function () {\n      return new ActiveXObject('Microsoft.XMLHTTP');\n    },\n  ];\n  let xhr = null;\n  for (let i = 0; i < XHR.length; i++) {\n    // \u5c1d\u8bd5\u8c03\u7528\u51fd\u6570\uff0c\u5982\u679c\u6210\u529f\u5219\u8fd4\u56de XMLHttpRequest \u5bf9\u8c61\uff0c\u5426\u5219\u7ee7\u7eed\u5c1d\u8bd5\n    try {\n      xhr = XHR[i]();\n    } catch (e) {\n      continue;\n      // \u5982\u679c\u53d1\u751f\u5f02\u5e38\uff0c\u5219\u7ee7\u7eed\u4e0b\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\n    }\n    break; // \u5982\u679c\u6210\u529f\uff0c\u5219\u4e2d\u6b62\u5faa\u73af\n  }\n  return xhr; // \u8fd4\u56de\u5bf9\u8c61\u5b9e\u4f8b\n}\nwindow.onload = function () {\n  // \u9875\u9762\u521d\u59cb\u5316\n  const b = document.getElementsByTagName('input')[0];\n  b.onclick = function () {\n    const url = 'server.php?callback=functionName';\n    //\u8bbe\u7f6e\u5411\u670d\u52a1\u5668\u7aef\u53d1\u9001\u8bf7\u6c42\u7684\u6587\u4ef6\uff0c\u4ee5\u53ca\u4f20\u9012\u7684\u53c2\u6570\u4fe1\u606f\n    const xhr = createXHR(); // \u5b9e\u4f8b\u5316 XMLHttpRequest \u5bf9\u8c61\n    xhr.open('GET', url, false); // \u5efa\u7acb\u8fde\u63a5\n    xhr.send(null); // \u53d1\u9001\u8bf7\u6c42\n    console.log(xhr.responseText); // \u63a5\u6536\u6570\u636e\n  };\n};\n"})})]})}function d(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(u,{...n})}):u(n)}},25502(n,e,t){t.d(e,{R:()=>o,x:()=>a});var r=t(10162);const i={},s=r.createContext(i);function o(n){const e=r.useContext(s);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:o(n.components),r.createElement(s.Provider,{value:e},n.children)}}}]);