"use strict";(globalThis.webpackChunknotebook=globalThis.webpackChunknotebook||[]).push([[89357],{44106(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"webSQl/\u4f8b","title":"\u4f8b","description":"\u4f7f\u7528 window \u5bf9\u8c61\u7684 openDatabase() \u65b9\u6cd5\uff0c\u53ef\u4ee5\u5728\u7f51\u9875\u5185\u521b\u5efa\u548c\u4f7f\u7528 Web SQL Database \uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a","source":"@site/html/webSQl/\u4f8b.mdx","sourceDirName":"webSQl","slug":"/webSQl/\u4f8b","permalink":"/html/webSQl/\u4f8b","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"\u4f8b"},"sidebar":"RRhFQ58Ul1J5KCbn","previous":{"title":"\u6ce8\u5165\u7f3a\u9677","permalink":"/html/webSQl/\u6ce8\u5165\u7f3a\u9677"},"next":{"title":"indexedDB","permalink":"/html/indexedDB/"}}');var a=t(56730),s=t(25502);const l={title:"\u4f8b"},i="\u7b2c 1 \u4e2a Web SQL Database \u5e94\u7528",o={},c=[{value:"\u5355\u6b21",id:"\u5355\u6b21",level:2},{value:"\u6279\u91cf",id:"\u6279\u91cf",level:2}];function m(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"\u7b2c-1-\u4e2a-web-sql-database-\u5e94\u7528",children:"\u7b2c 1 \u4e2a Web SQL Database \u5e94\u7528"})}),"\n",(0,a.jsx)(n.p,{children:"\u4f7f\u7528 window \u5bf9\u8c61\u7684 openDatabase() \u65b9\u6cd5\uff0c\u53ef\u4ee5\u5728\u7f51\u9875\u5185\u521b\u5efa\u548c\u4f7f\u7528 Web SQL Database \uff0c\u793a\u4f8b\u4ee3\u7801\u5982\u4e0b\uff1a"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:"showLineNumbers",children:"/**\n *\n */\nfunction queryResult(tx, result) {\n  try {\n    const rowList = result.rows;\n    for (let i = 0; i < rowList.length; i++) {\n      const row = rowList.item(i);\n      for (const j in row) {\n        console.log(j + '= ' + row[j] + '; ');\n      }\n    }\n  } catch (err) {\n    alert(err.message ? err.message : err.toString());\n  }\n}\n/**\n *\n */\nfunction queryError(tx, err) {\n  alert(err.message ? err.message : err.toString());\n}\n/**\n *\n */\nfunction callback(tx) {\n  let sql;\n  sql =\n    'CREATE TABLE employees(firstName TEXT, lastName TEXT, EmpType TEXT, age INTEGER)';\n  tx.executeSql(sql);\n  sql =\n    \"INSERT INTO employees(firstName, lastName, EmpType, age) VALUES(' myFirst ', ' myLast ',' myEmpType ', 40)\";\n  tx.executeSql(sql);\n  sql =\n    'INSERT INTO employees(firstName, lastName, EmpType, age) VALUES( ? , ? , ? , ? )';\n  tx.executeSql(sql, ['myFirst', 'myLast', 'myEmpType', 40]);\n  sql = 'select _ FROM employees ';\n  tx.executeSql(sql, [], queryResult, queryError);\n}\ntry {\n  var db = window.openDatabase(\n    'mydb',\n    '1.0',\n    ' \u6211\u7684\u7b2c\u4e00\u4e2a\u5ba2\u6237\u7aef\u6570\u636e\u5e93 ',\n    2 * 1024 * 1024,\n  );\n} catch (err) {\n  alert(err.message ? err.message : err.toString());\n}\nif (!db) alert('\u4e0d\u80fd\u8fde\u63a5\u5230\u6570\u636e\u5e93\uff01 ');\ndb.transaction(callback);\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u5355\u6b21",children:"\u5355\u6b21"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-html",metastring:"showLineNumbers",children:"<head>\n  <script>\n    var db = openDatabase('mydb', '1.0', 'Test DB', 2 * 1024 * 1024);\n    var msg;\n    db.transaction(function (tx) {\n      tx.executeSql('CREATE TABLE IF NOT EXISTS LOGS (id unique, log)');\n      t;\n      x.executeSql('INSERT INTO LOGS (id, log) VALUES (1, \"foobar\")');\n      tx.executeSql('INSERT INTO LOGS (id, log) VALUES (2, \"logmsg\")');\n      msg = '<p> \u5b8c\u6210\u6d88\u606f\u521b\u5efa\u548c\u63d2\u5165\u884c\u64cd\u4f5c\u3002 </p>';\n      document.querySelector('#status').innerHTML = msg;\n    });\n    db.transaction(function (tx) {\n      tx.executeSql(\n        'select \\* FROM LOGS',\n        [],\n        function (tx, results) {\n          var len = results.rows.length,\n            i;\n          msg = '<p> \u67e5\u8be2\u884c\u6570 : ' + len + '</p>';\n          document.querySelector('#status').innerHTML += msg;\n          for (i = 0; i < len; i++) {\n            msg = '<p><b>' + results.rows.item(i).log + '</b></p>';\n            document.querySelector('#status').innerHTML += msg;\n          }\n        },\n        null,\n      );\n    });\n  <\/script>\n  <meta charset=\"utf-8\" />\n</head>\n\n<body>\n  <div id=\"status\" name=\"status\"></div>\n</body>\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u6279\u91cf",children:"\u6279\u91cf"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-html",metastring:"showLineNumbers",children:"<head>\n  <meta charset=\"utf-8\" />\n  <title></title>\n</head>\n<body>\n  <table id=\"racers\" border=\"1\" cellspacing=\"0\" style=\"width:100%\">\n    <th>Id</th>\n    <th>Name</th>\n  </table>\n  <script>\n    // \u6839\u636e\u540d\u79f0 name \u6253\u5f00\u6570\u636e\u5e93\n    var db = openDatabase('db', '1.0', 'my first database', 2 * 1024 * 1024);\n    function log(id, name) {\n      var row = document.createElement('tr');\n      var idCell = document.createElement('td');\n      var nameCell = document.createElement('td');\n      idCell.textContent = id;\n      nameCell.textContent = name;\n      row.appendChild(idCell);\n      row.appendChild(nameCell);\n      document.getElementById('racers').appendChild(row);\n    }\n    function doQuery() {\n      db.transaction(function (tx) {\n        tx.executeSql('select * from mytable', [], function (tx, result) {\n          // \u663e\u793a\u67e5\u8be2\u7684\u8bb0\u5f55\u96c6\n          for (var i = 0; i < result.rows.length; i++) {\n            var item = result.rows.item(i);\n            log(item.id, item.name);\n          }\n        });\n      });\n    }\n    function initDatabase() {\n      var names = [\n        ' \u5f20\u4e09 ',\n        '\u674e\u56db ',\n        ' \u738b\u4e94 ',\n        ' \u8d75\u516d ',\n        ' \u4faf\u4e03 ',\n        'abc',\n        'def',\n      ];\n      db.transaction(function (tx) {\n        tx.executeSql(\n          'CREATE TABLE IF NOT EXISTS  mytable(id integer primary key autoincrement, name)',\n        );\n        for (var i = 0; i < names.length; i++) {\n          tx.executeSql('INSERT INTO mytable (name) VALUES (?)', [names[i]]);\n        }\n        doQuery();\n      });\n    }\n    initDatabase();\n  <\/script>\n</body>\n"})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(m,{...e})}):m(e)}},25502(e,n,t){t.d(n,{R:()=>l,x:()=>i});var r=t(10162);const a={},s=r.createContext(a);function l(e){const n=r.useContext(s);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);